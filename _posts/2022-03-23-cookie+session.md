---
layout: single
title: "쿠키와 세션"
categories: cookie+session
permalink: cookie+session/chapter01
toc: true
author_profile: true
sidebar_main: true
---

# 쿠키와 세션의 사용 이유

HTTP 통신에서의 <u>stateless</u>라는 특징으로 인해 쿠키와 세션이 사용되어 집니다.<br>

**무상태(stateless)**라는 것은
클라이언트의 정보를 서버가 저장하지 않고 단순히 요청에 대한 응답만 하는 것 입니다.<br>

이러한 HTTP통신의 stateless한 특징을 가지고 stateful 서비스를 제공해주려고 할 때 쿠키와 세션을 사용합니다.

# 쿠키(cookie)란

**해당 웹사이트에서의 정보들이 저장된 파일입니다.**

해당 웹사이트에서 클라이언트를 식별하기 위해서 사용되고 쿠키는 <u>클라이언트의 하드디스크에 저장</u>이 됩니다.

쿠키는 key-value의 형태로 정보가 저장이 되고 쿠키가 저장된 상태에서 서버로 요청으로 보낼 때 쿠키의 정보를 헤더에 같이 보내고 서버에서 헤더에 대한 응답으로 쿠키의 정보를 같이 받아 클라이언트의 정보를 유지시킵니다.

## 쿠키의 특징

- cookie:name=value(쿠키의 key-value),expires(만료일),path(url 정보 혹은 경로),domain이 저장됩니다..
- 하나의 쿠키는 4KB까지 저장가능합니다.<br>(브라우저마다 다를 수 있음)
- 클라이언트는 300개 정도의 쿠키를 저장할 수 있습니다.
- 도메인은 20개 정도의 쿠키를 가질 수 있습니다.

## 쿠키의 동작

1. 클라이언트가 서버에 요청할 때 쿠키에 저장할 정보를 Header의 Set-Cookie로 전달합니다.
   ```
    Set-Cookie=<cookie-name>=<cookie-value>
   ```
2. 서버에 쿠키를 저장하고 클라이언트가 다시 서버에 요청 할 때 저장된 쿠키를 Header의 Cookie로 전달합니다.
   ```
   Cookie:<cookie-name>=<cookie-value>
   ```
3. 서버에서 클라이언트에게 받은 쿠키의 정보와 같이 응답합니다.
   ```
    HTTP/1.1 200 OK
    Date:요일, 날짜 달 년도 시간
    Content-Type:text/html; charset=UTF-8
    Set-Cookie:cookie=key~
   ```
4. 이렇게 응답을 받고 난 이후 서버에게 요청 시 Header에 쿠키의 정보를 포함해서 전달합니다.
   ```
    GET /~.html HTTP/1.1
    Accept: *
    Cookie:cookie=key
   ```

## 쿠키 예시

1. 아이디,비밀번호등을 저장할 경우
2. 최근 본 물건 혹은 검색내용
3. 장바구니
4. 몇일간 보지 않음 설정

## 쿠키의 단점

1. 클라이언트가 쿠키를 임의로 수정할 수 있다.
2. 개인정보가 기록되기 때문에 사생활을 침해할 여지가 있다.
3. 요청을 가로채기 쉬워서 보안에 취약합니다.

# 세션(Session)

사용자 중요 정보를 <u>서버측에서 관리</u>해서 해당 정보를 유지시키는 것입니다.<br>
서버에서 관리하는 만큼 보안에서는 쿠키보다 안전합니다.

## 세션의 특징

- 각 클라이언트에게 고유ID를 부여합니다.
- 세션 ID로 클라이언트에게 정보를 제공해줍니다.
- 서버에서 중요 정보를 관리하기 때문에 보안에서 안전합니다.
- 서버에서 정보를 관리하는 만큼 사용자가 많아지면 서버 메모리를 많이 차지합니다.

## 세션의 동작

1. 클라이언트가 요청합니다.
2. 서버는 세션ID를 만들어 클라이언트의 정보를 세션ID와 같이 저장합니다.
3. 생성한 세션ID를 쿠키에 담아 클라이언트에게 응답합니다.
4. 클라이언트는 전달받은 세션ID값을 요청시 Header쿠키에 같이 담아서 전달합니다.
5. 서버는 세션ID로 사용자를 식별합니다.

## 세션 예시

- 로그인 후 해당 페이지에서 도메인이 같은 다른 페이지로 이동할 때 로그인을 유지 경우입니다.

## 쿠키와 세션의 차이

|          |       쿠키       | 세션                         |
| :------- | :--------------: | ---------------------------- |
| 저장위치 |    클라이언트    | 웹서버                       |
| 저장형식 |       Text       | Object                       |
| 만료시점 | 쿠키 저장시 설정 | 브라우저 종료(따로 설정가능) |
| 속도     |  세션보다 빠름   | 쿠키보다 느림                |
| 보안     | 세션보다 불안전  | 쿠키보다 안전                |

참조 사이트

- [강준현님의 깃헙블로그]<br><https://junhyunny.github.io/information/cookie-and-session/>
- [세상에 도움되는 블로그]<br><https://lovefor-you.tistory.com/247>
- [Ryan님의 티스토리]<br><https://interconnection.tistory.com/74>
